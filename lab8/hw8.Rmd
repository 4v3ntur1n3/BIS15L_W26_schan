---
title: "Homework 8"
author: "Stanley Chan"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
    keep_md: yes
---

## Instructions
Answer the following questions and/or complete the exercises in RMarkdown. Please embed all of your code and push the final work to your repository. Your report should be organized, clean, and run free from errors. Remember, you must remove the `#` for any included code chunks to run.  

## Load the libraries
```{r message=FALSE, warning=FALSE}
library("tidyverse")
library("janitor")
library("naniar")
options(scipen = 999)
```

## About the Data
For this assignment we are going to work with a data set from the [United Nations Food and Agriculture Organization](https://www.fao.org/fishery/en/collection/capture) on world fisheries. These data were downloaded and cleaned using the `fisheries_clean.Rmd` script.  

Load the data `fisheries_clean.csv` as a new object titled `fisheries_clean`.
```{r message=FALSE, warning=FALSE}
fisheries_clean <- read_csv("data/fisheries_clean.csv")
```

1. Explore the data. What are the names of the variables, what are the dimensions, are there any NA's, what are the classes of the variables, etc.? You may use the functions that you prefer.
```{r}
glimpse(fisheries_clean)
```

```{r}
summary(fisheries_clean)
```

2. Convert the following variables to factors: `period`, `continent`, `geo_region`, `country`, `scientific_name`, `common_name`, `taxonomic_code`, and `status`.
```{r}
fisheries_clean <- fisheries_clean %>% 
  mutate(across(c(period, continent, geo_region, country, scientific_name, common_name, taxonomic_code, status), as.factor))
```

3. Are there any missing values in the data? If so, which variables contain missing values and how many are missing for each variable?
```{r}
#Skip
```

4. How many countries are represented in the data?
```{r}
fisheries_clean %>% 
  summarize(n_countries=n_distinct(country))
```

5. The variables `common_name` and `taxonomic_code` both refer to species. How many unique species are represented in the data based on each of these variables? Are the numbers the same or different?
```{r}
fisheries_clean %>% 
  summarize(n_species_commonname=n_distinct(common_name))
```

```{r}
fisheries_clean %>% 
  summarize(n_species_taxcode=n_distinct(taxonomic_code))
```

According to the data, there are 3390 distinct common names and 3722 distinct taxonomic codes. The number of unique species based on common name and taxonomic code are relatively close to each other, with a difference of 332 unique species.

6. In 2023, what were the top five countries that had the highest overall catch?
```{r}
fisheries_clean %>% 
  filter(period=="2023") %>% 
  group_by(country) %>% 
  summarize(highest_overall_catch=sum(catch)) %>% 
  slice_max(highest_overall_catch, n=5)
```

7. In 2023, what were the top 10 most caught species? To keep things simple, assume `common_name` is sufficient to identify species. What does `NEI` stand for in some of the common names? How might this be concerning from a fisheries management perspective?
```{r}
fisheries_clean %>% 
  filter(period=="2023") %>% 
  group_by(common_name) %>% 
  summarize(max_caught_species=sum(catch, na.rm=T)) %>% 
  arrange(desc(max_caught_species)) %>% 
  slice_head(n=10)
```

NEI stands for "Not Elsewhere Included" and represents fish catches that are unidentified or mixed. This could be a problem for fisheries management because they can't keep track of these unidentified fishes, which could lead to over-fishing and endangerment of certain species.

8. For the species that was caught the most above (not NEI), which country had the highest catch in 2023?
```{r}
fisheries_clean %>% 
  filter(period=="2023" & common_name=="Alaska pollock(=Walleye poll.)") %>% 
  group_by(country) %>% 
  summarize(overall_catch_alaskapollock=sum(catch, na.rm=T)) %>% 
  arrange(desc(overall_catch_alaskapollock)) %>% 
  slice_head(n=1)
```

9. How has fishing of this species changed over the last decade (2013-2023)? Create a plot showing total catch by year for this species.
```{r}
fisheries_clean %>% 
  filter(common_name=="Alaska pollock(=Walleye poll.)") %>% 
  filter(period %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023")) %>% 
  group_by(period) %>% 
  summarize(overall_catch_wpoll=sum(catch)) %>% 
  ggplot(aes(x=period, y=overall_catch_wpoll))+
  geom_point()+
  labs(title="Overall Catches of Alaska Pollock in the Last Decade", x="Period (years)", y="Number of Alaska Pollock Caught")
```

Fishing of this species has increased from the start to the end of the last decade.

10. Perform one exploratory analysis of your choice. Make sure to clearly state the question you are asking before writing any code.
With the global population increasing each year, has the overall catches all all fish increased each year to compensate for it?
* To reduce x-axis clutter, I'll be take the overall catches between 5 years.

```{r}
fisheries_clean %>% 
  filter(period %in% c(1950, 1955, 1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020)) %>% 
  group_by(period) %>% 
  summarize(overall_catches=sum(catch)) %>% 
  ggplot(aes(x=period, y=overall_catches))+
  geom_point()+
  labs(title="Global Overall Catches Every 5 Years", x="Period (years)", y="Number of Fish Caught")
```

Based on the graph, there is a noticeable increase in the overall number of fish caught in the world from 1950 to 1995. However, around 1995 is where the graph stays at about 92,500,000 fish caught and it persists through the future years up to 2020. Without doing extensive research, I could assume that the increased rate of fish caught slowed down due to regulations involving endangered fish species. Future research could be done to take specific species of endangered fish to see if its rate of being caught matches the rate that this overall fish catches graph displays.

## Knit and Upload
Please knit your work as an .html file and upload to Canvas. Homework is due before the start of the next lab. No late work is accepted. Make sure to use the formatting conventions of RMarkdown to make your report neat and clean!  